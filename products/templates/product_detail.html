{% extends "base/base.html" %}
{% load static %}
{% block title %}
<title>product</title>
{% endblock title  %}

{% block content %}

<section class="py-12 md:py-14 bg-black">
    <div class="container mx-auto px-4">
      <div class="max-w-md md:max-w-none mx-auto">
        <ul class="flex items-center">
          <li class="mr-3">
            <a class="text-gray-400 font-medium" href="#">Home</a>
            <span class="pl-2 text-gray-400">/</span>
          </li>
          <li class="mr-3">
            <a class="text-gray-400 font-medium" href="#">Fashion</a>
            <span class="pl-2 text-gray-400">/</span>
          </li>
          <li><a class="text-yellow-500 font-medium" href="#">{{product.name}}</a></li>
        </ul>
        <div class="flex flex-wrap mt-10 -mx-4">
          <div class="w-full md:w-1/2 lg:w-3/5 xl:w-2/3 mb-12 md:mb-0 px-4">
            <div class="max-w-3xl">
              <div class="lg:flex h-full">
                <div class="lg:flex-shrink-0 lg:w-20 lg:mr-6">
                  <div class="flex lg:-mb-4 lg:block justify-between">
                    <a class="block mb-4" href="#">
                      <img class="block sm:w-20 h-20" src="{% static 'assets/images/product-details/clothes1.png' %}" alt="">
                    </a>
                    <a class="block mb-4" href="#">
                      <img class="block sm:w-20 h-20" src="{% static 'assets/images/product-details/clothes2.png' %}" alt="">
                    </a>
                    <a class="block mb-4" href="#">
                      <img class="block sm:w-20 h-20" src="{% static 'assets/images/product-details/clothes3.png' %}" alt="">
                    </a>
                    <a class="block mb-4" href="#">
                      <img class="block sm:w-20 h-20" src="{% static 'assets/images/product-details/clothes4.png' %}" alt="">
                    </a>
                  </div>
                </div>
                <div>
                  <img class="block h-full w-full max-w-4xl" src="{% static 'assets/images/product-details/clothes-big-1.png' %}" alt="">
                </div>
              </div>
            </div>
          </div>
          <div class="w-full md:w-1/2 lg:w-2/5 xl:w-1/3 px-4">
            <div class="p-8 h-full border border-blueGray-800">
              <div class="pb-8 border-b border-blueGray-800">
                <span class="inline-block px-2 text-sm mb-5 bg-yellow-500 font-medium rounded-full">Hot</span>
                <h4 class="font-heading font-bold text-2xl text-white mb-3">{{product.name}}</h4>
                <!--<p class="text-gray-400 mb-6">Lorem ipsum dolor sit amet, consectetur adipiscing a elit. Nullam to the dictum aliquet accum.</p>-->
                <span class="block mb-1 text-gray-500 font-medium line-through">4500 DZD</span>
                <div class="inline-flex items-end">
                  <h4 class="text-2xl font-bold text-white mr-4">{{product.price}} DZD</h4>
                  <span class="text-yellow-500">%25 OFF</span>
                </div>
              </div>
              <div class="pt-8 pb-8 ">
                <div class="max-w-xs xl:pr-20">
                  <form method="POST">
                    {% csrf_token %}
                    {{ form.non_field_errors }}

                    <div class="mb-6">
                      {{ form.first_name.errors }}
                      {{ form.first_name }}
                   </div>

                  <div class="mb-6">
                    {{ form.last_name.errors }}
                    {{ form.last_name }}
                  </div>

                    <div class="mb-6">
                        {{ form.state.errors }}
                        {{ form.state }}
                    </div>
                    <div class="mb-6">
                        {{ form.city.errors }}
                        {{ form.city }}
                    </div>
                    <div class="mb-6">
                        {{ form.full_adress.errors }}
                        {{ form.full_adress }}
                    </div>
                    
                    <div class="mb-6">
                      {% if form.phone_number.errors %}
                      {% for error in form.phone_number.errors %}
                        <p class="text-yellow-500 mb-2">{{ error }}</p>
                      {% endfor %}
                      {% endif %}
                      {{ form.phone_number }}
                    </div>
            
                    <div class="mb-6">
                      {{ form.quantity.errors }}
                      {{ form.quantity }}
                   </div>
                    <button type="submit" class="inline-block px-12 py-4 text-center text-black font-bold bg-yellow-500 hover:bg-yellow-600 transition duration-200">Create order</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

<!---
    <div class="container">
        <div class="row">
            <div class="col-md-6"></div>
            <div class="col-md-6">
                <h1>{{product.name}}</h1>

                <form method="POST" >
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <div>
                        {{ form.state.errors }}
                        <label for="{{ form.state.id_for_label }}">State:</label>
                        {{ form.state }}
                    </div>
                    <div>
                        {{ form.city.errors }}
                        <label for="{{ form.city.id_for_label }}">City:</label>
                        {{ form.city }}
                    </div>
                    <div>
                        {{ form.street.errors }}
                        <label for="{{ form.street.id_for_label }}">Street:</label>
                        {{ form.street }}
                    </div>
                    <div>
                        {{ form.product.errors }}
                        <label for="{{ form.product.id_for_label }}">Product:</label>
                        {{ form.product }}
                    </div>
                    <div>
                        {{ form.quantity.errors }}
                        <label for="{{ form.quantity.id_for_label }}">Quantity:</label>
                        {{ form.quantity }}
                    </div>
                    <div>
                        {{ form.phone_number.errors }}
                        <label for="{{ form.phone_number.id_for_label }}">Phone Number:</label>
                        {{ form.phone_number }}
                    </div>
                    <input type="submit" value="Create Order">
                </form>

            </div>
        </div>
    </div>
-->  
{% endblock content %}

{% block scripts  %}
<script>
    const stateCityData = {
        {% for state in states %}
        "{{ state.id }}": [
            {% for city in state.commune_set.all %}
            { "id": "{{ city.id }}", "name": "{{ city.display_name }}" },
            {% endfor %}
        ],
        {% endfor %}
    };

    const stateSelect = document.querySelector('#id_state');
    const citySelect = document.querySelector('#id_city');

    stateSelect.addEventListener('change', () => {
        const selectedState = stateSelect.value;
        if (selectedState) {
            populateCityOptions(selectedState);
        } else {
            clearCityOptions();
        }
    });

    function populateCityOptions(stateId) {
        const cities = stateCityData[stateId];
        citySelect.innerHTML = '';
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city.id;
            option.text = city.name;
            citySelect.appendChild(option);
        });
    }

    function clearCityOptions() {
        citySelect.innerHTML = '<option value="">Select a state first</option>';
    }
</script>
{% endblock %}